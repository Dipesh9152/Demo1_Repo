package org.kale.auction.pages;

import org.kale.auction.sdk.Variables_Declaration;
import org.kale.auction.utils.General_Methods;
import org.kale.auction.utils.Validate_Elements;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.interactions.Actions;

public class FINAL_NOTICE_Page 
{
	WebDriver driver;	
	Variables_Declaration vd=new Variables_Declaration();
	General_Methods gm=new General_Methods();
	Validate_Elements ve=new Validate_Elements();
	
	public FINAL_NOTICE_Page(WebDriver dr)
	{
		driver=dr;
	}
	
	public void FinalNotice_Able_To_Send_FinalNotice(String SC_ID,String Description,String ExcelSavePath,String IGM_No, String Notice1_UploadFilePath,String FN_Sent_Date,String File_Name, 
			String Remarks,String FN_Importer_Reply_Date,String Importer_remark) throws Exception
	{		
		driver.findElement(By.id("ctl00_hldPage_txtsrch")).sendKeys(IGM_No);
		
		driver.findElement(By.id("ctl00_hldPage_btnSrch")).click();
		 
		Thread.sleep(1000);
		
		driver.findElement(By.id("ctl00_hldPage_grdAuctionHome_ctl02_lbigmno")).click();
		
		driver.findElement(By.xpath("//a[contains(.,'Final Notice')]")).click();
		
		driver.findElement(By.id("ctl00_hldPage_btnedit")).click();
		
		driver.findElement(By.id("ctl00_hldPage_fileupload3")).sendKeys(Notice1_UploadFilePath);
		
		driver.findElement(By.id("ctl00_hldPage_btnfinalNoticeUpload")).click();
		
		driver.findElement(By.id("ctl00_hldPage_TextBox4")).sendKeys(FN_Sent_Date);
		ve.Data_TextBox(SC_ID, Description, vd.Srno, vd.r,"Sent_ Date", "ctl00_hldPage_txtsentdate", driver, ExcelSavePath, vd.StartTime);
		
		driver.findElement(By.id("ctl00_hldPage_txtfilenamefinlnotic")).sendKeys(File_Name);
		ve.Data_TextBox(SC_ID, Description, vd.Srno, vd.r,"File _Name", "ctl00_hldPage_txtfilename", driver, ExcelSavePath, vd.StartTime);
		
		driver.findElement(By.id("ctl00_hldPage_txtremarkfinlnotic")).sendKeys(Remarks);
		ve.Data_TextBox(SC_ID, Description, vd.Srno, vd.r,"Remark", "ctl00_hldPage_txtremarknotice1", driver, ExcelSavePath, vd.StartTime);
		
		driver.findElement(By.id("ctl00_hldPage_txtimprplydatfinlnotic")).sendKeys(FN_Importer_Reply_Date);
		ve.Data_TextBox(SC_ID, Description, vd.Srno, vd.r,"Importer Reply Date", "ctl00_hldPage_txtimporterreplydate", driver, ExcelSavePath, vd.StartTime);
		
		driver.findElement(By.id("ctl00_hldPage_txtimpremrkfinlnotic")).sendKeys(Importer_remark);
		ve.Data_TextBox(SC_ID, Description, vd.Srno, vd.r,"Importer remark", "ctl00_hldPage_txtimporterremark", driver, ExcelSavePath, vd.StartTime);
		
		driver.findElement(By.id("ctl00_hldPage_fuctfnDocReply")).sendKeys(Notice1_UploadFilePath);
		
		driver.findElement(By.id("ctl00_hldPage_btnfnDocReply")).click();
		
		driver.findElement(By.id("ctl00_hldPage_btnsavenextfinlnotic")).click();	
		
		vd.Save_Message=driver.findElement(By.id("ctl00_hldPage_DivMessage")).getText();
		
		if(vd.Save_Message.equals("Record Updated Successfully"))
		{
			vd.Status="PASS";
		}
		else
		{
			vd.Status="FAIL";
		}		
		ve.Message(SC_ID, Description, vd.Srno, vd.r, vd.Status,"Record Updated Successfully", driver, ExcelSavePath, vd.StartTime);		
	}

	 public void FinalNotice_CFSLogin_Redirect_UCCDashboard_From_FinalNotice(String SC_ID,String Description,String ExcelSavePath,String IGM_No) throws Exception
	 {
		 	driver.findElement(By.xpath("//a[contains(.,'Final Notice')]")).click();
		 	
		 	driver.findElement(By.id("ctl00_hldPage_btnback")).click();
		 	
			Thread.sleep(1000);
			
			vd.QuickSearch=gm.TryFindElement_id(driver,"ctl00_hldPage_txtsrch");
			
			if(vd.QuickSearch==true)
			{
				vd.Status="PASS";
			}
			else
			{
				vd.Status="FAIL";
			}
			ve.webElement_Present(SC_ID, Description, vd.Srno, vd.r, vd.Status, "Quick Search", driver, ExcelSavePath, vd.StartTime);
		
	 }
	
	 public void FinalNotice_CustomOnlyView_FinalNoticeDetails_FromUCCDashboard(String SC_ID, String Description, String ExcelSavePath,String IGM_No) throws Exception
		{
		 	
		 	
			driver.findElement(By.id("ctl00_hldPage_txtCuHome")).sendKeys(IGM_No);
			driver.findElement(By.id("ctl00_hldPage_btnSrch")).click();
						
			driver.findElement(By.id("ctl00_hldPage_GridCuHome_ctl02_lbIGMNo")).click();
			
			Thread.sleep(2000);	
			
			driver.findElement(By.xpath("//a[contains(.,'Final Notice')]")).click();
		 	Thread.sleep(1000);	
			vd.WebElement_PreAbs=gm.TryFindElement_id(driver, "ctl00_hldPage_btnedit");
			
			if(vd.WebElement_PreAbs==false)
			{
				vd.Status="PASS";
			}
			else
			{
				vd.Status="FAIL";
			}
			ve.webElement_absent(SC_ID, Description, vd.Srno, vd.r, vd.Status, "Edit Button", driver, ExcelSavePath, vd.StartTime);
		}
	 
	 public void FinalNotice_CustomLogin_Redirect_UCCDashboard_From_FinalNotice(String SC_ID,String Description,String ExcelSavePath,String IGM_No) throws Exception
	 {
		 	driver.findElement(By.id("ctl00_hldPage_btnback")).click();
		 	
			Thread.sleep(1000);
			
			vd.QuickSearch=gm.TryFindElement_id(driver,"ctl00_hldPage_txtCuHome");
			
			if(vd.QuickSearch==true)
			{
				vd.Status="PASS";
			}
			else
			{
				vd.Status="FAIL";
			}
			ve.webElement_Present(SC_ID, Description, vd.Srno, vd.r, vd.Status, "Quick Search", driver, ExcelSavePath, vd.StartTime);		
	 }
	
	 public void FinalNotice_CustomOnlyView_FinalNoticeDetails_FromNOCDashboard(String SC_ID, String Description, String ExcelSavePath,String IGM_No) throws Exception
		{
			driver.findElement(By.xpath("//a[contains(.,'NOC DashBoard')]")).click();
			
			driver.findElement(By.id("ctl00_hldPage_txtNOCCuGroup")).sendKeys(IGM_No);
			driver.findElement(By.id("ctl00_hldPage_Button1")).click();
			
			driver.findElement(By.id("ctl00_hldPage_NocCuGroup_ctl02_LbIGMNo")).click();
			Thread.sleep(2000);	
			driver.findElement(By.xpath("//a[contains(.,'Final Notice')]")).click();
		
			vd.WebElement_PreAbs=gm.TryFindElement_id(driver, "ctl00_hldPage_btnedit");
			
			if(vd.WebElement_PreAbs==false)
			{
				vd.Status="PASS";
			}
			else
			{
				vd.Status="FAIL";
			}
			ve.webElement_absent(SC_ID, Description, vd.Srno, vd.r, vd.Status, "Edit Button", driver, ExcelSavePath, vd.StartTime);
		
		}
	 
	 public void FinalNotice_CustomLogin_Redirect_NOCDashboard_From_FinalNotice(String SC_ID, String Description, String ExcelSavePath,String IGM_No) throws Exception
		{
			driver.findElement(By.id("ctl00_hldPage_btnback")).click();
			
			vd.QuickSearch=gm.TryFindElement_id(driver,"ctl00_hldPage_txtNOCCuGroup");
			
			if(vd.QuickSearch==true)
			{
				vd.Status="PASS";
			}
			else
			{
				vd.Status="FAIL";
			}
			ve.webElement_Present(SC_ID, Description, vd.Srno, vd.r, vd.Status, "Quick Search", driver, ExcelSavePath, vd.StartTime);		
		}
	 
	 public void FinalNotice_GroupUser_OnlyViewFinalNotice_From_GroupNOCDashboard(String SC_ID, String Description, String ExcelSavePath,String IGM_No) throws Exception
		{
//			driver.findElement(By.id("ctl00_hldPage_txtnoccudash")).sendKeys(IGM_No);
//			driver.findElement(By.id("ctl00_hldPage_btnSrch")).click();
			
			driver.findElement(By.id("ctl00_hldPage_grdAuctionNOCHome_ctl02_lblIGMNo")).click();
			Thread.sleep(2000);	
			driver.findElement(By.xpath("//a[contains(.,'Final Notice')]")).click();
		
			vd.WebElement_PreAbs=gm.TryFindElement_id(driver, "ctl00_hldPage_btnedit");
			
			if(vd.WebElement_PreAbs==false)
			{
				vd.Status="PASS";
			}
			else
			{
				vd.Status="FAIL";
			}
			ve.webElement_absent(SC_ID, Description, vd.Srno, vd.r, vd.Status, "Edit Button", driver, ExcelSavePath, vd.StartTime);	
		}
	
	 public void FinalNotice_GroupUser_Redirect_FinalNotice_To_GroupNOCDashboard(String SC_ID, String Description, String ExcelSavePath,String IGM_No) throws Exception
		{
			driver.findElement(By.id("ctl00_hldPage_btnback")).click();
			
			vd.QuickSearch=gm.TryFindElement_id(driver,"ctl00_hldPage_txtnoccudash");
			
			if(vd.QuickSearch==true)
			{
				vd.Status="PASS";
			}
			else
			{
				vd.Status="FAIL";
			}
			ve.webElement_Present(SC_ID, Description, vd.Srno, vd.r, vd.Status, "Quick Search", driver, ExcelSavePath, vd.StartTime);
			
		}
	 
	public void FinalNotice_Support_Method(String SC_ID,String Description,String ExcelSavePath,String IGM_No) throws Exception
	{
		driver.findElement(By.xpath("//a[contains(.,'NOC DashBoard')]")).click();
		
		driver.findElement(By.id("ctl00_hldPage_txtNOCCuGroup")).sendKeys(IGM_No);
		driver.findElement(By.id("ctl00_hldPage_Button1")).click();
		
		driver.findElement(By.id("ctl00_hldPage_NocCuGroup_ctl02_LbIGMNo")).click();
		Thread.sleep(2000);	
	}
	
	 public void Logout() throws Exception
		{
			Thread.sleep(1000);	
			WebElement logout_mouseover=driver.findElement(By.id("ctl00_Label4"));
			Actions action=new Actions(driver);
			
			action.moveToElement(logout_mouseover).perform();
//			Thread.sleep(1000);
			WebElement LogBtn=driver.findElement(By.id("ctl00_lnkSignout"));
			LogBtn.click();
		}
}
